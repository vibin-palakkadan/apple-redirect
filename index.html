<!-- redirect.html -->
<!-- <!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Redirecting...</title>
    <script>
      window.onload = function () {
        const params = new URLSearchParams(window.location.search);
        const code = params.get('code');
        const state = params.get('state');
        const targetUrl = `http://localhost:5000/?code=${code}&state=${state}`;

        // Redirect to your Flutter local server or wherever your app is running
        window.location.href = targetUrl;
      };
    </script>
  </head>
  <body>
    Redirecting to your app...
  </body>
</html>
 --> 
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Redirecting...</title>
</head>
<body>
  <p>Redirecting...</p>
  <script>
    window.onload = function () {
      try {
        const form = document.forms[0];
        if (!form) {
          document.body.innerHTML = "<p style='color:red;'>Form not found. This page should only be opened by Apple Sign In.</p>";
          return;
        }

        const code = form.querySelector('input[name="code"]')?.value;
        const idToken = form.querySelector('input[name="id_token"]')?.value;
        const state = form.querySelector('input[name="state"]')?.value;

        // âœ… Redirect to your app with the values in query parameters
        const redirectUrl = `https://your-flutter-web-url/#/apple-redirect?code=${encodeURIComponent(code)}&id_token=${encodeURIComponent(idToken)}&state=${encodeURIComponent(state)}`;
        window.location.replace(redirectUrl);
      } catch (e) {
        console.error("Failed to extract Apple login data:", e);
        document.body.innerHTML = "<p style='color:red;'>Error processing Apple login response.</p>";
      }
    };
  </script>
</body>
</html>

